(()=>{"use strict";const e=e=>{const t=document.getElementById("tbody");t.innerHTML="",e.forEach((e=>{const n=document.createElement("tr");n.classList.add("table__row"),n.innerHTML=`\n        <td class="table__id table__cell">${e.id}</td>\n        <td class="table-type table__cell">${e.type}</td>\n        <td class="table-name table__cell">\n          ${e.name}\n        </td>\n        <td class="table-units table__cell">\n          ${e.units}\n        </td>\n        <td class="table-cost table__cell">\n          ${e.cost} руб\n        </td>\n        <td>\n          <div class="table__actions table__cell">\n            <button class="button action-change"><span class="svg_ui"><svg class="action-icon_change">\n                  <use xlink:href="./img/sprite.svg#change"></use>\n                </svg></span><span>Изменить</span>\n            </button>\n            <button class="button action-remove"><span class="svg_ui"><svg class="action-icon_remove">\n                  <use xlink:href="./img/sprite.svg#remove"></use>\n                </svg></span><span>Удалить</span>\n            </button>\n          </div>\n        </td>\n      `,t.append(n)}))};window.databaseService=new class{getData(e){return fetch(e).then((e=>e.json()))}sendData(e,t,n){return fetch(e,{method:t,body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((e=>e.json()))}getServices(){return this.getData("http://localhost:4444/services")}getFilterServices(e,t){return this.getData(`http://localhost:4444/services?${e}=${t}`)}},(()=>{const e=document.querySelector("form"),t=document.getElementById("name"),n=document.getElementById("type"),a=document.querySelector(".text-warning-name"),s=document.querySelector(".text-warning-password");e.addEventListener("submit",(e=>{e.preventDefault(),fetch("http://localhost:4444/users").then((e=>e.json())).then((e=>(e=>{a.style.display="none",s.style.display="none",e.forEach((e=>{t.value===e.login&&n.value===e.password?(localStorage.setItem("auth",JSON.stringify({auth:!0})),(()=>{let e=new Date(2022,6,4);document.cookie=`name=${t.value}; expires=${e.toUTCString()};`})(),window.location.href="/table.html"):(t.value!==e.login&&(a.style.display="block"),n.value!==e.password&&(s.style.display="block"),t.value="",n.value="")}))})(e)))})),"/index.html"===window.location.pathname&&localStorage.removeItem("auth"),"/table.html"===window.location.pathname&&(localStorage.getItem("auth")||(window.location.href="/index.html"))})(),databaseService.getServices().then((t=>{(e=>{const t=document.getElementById("typeItem");(()=>{const n=new Set;e.forEach((e=>{n.add(e.type)})),n.forEach((e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.append(n)}))})()})(t),e(t)})),document.getElementById("typeItem").addEventListener("change",(t=>{"Все услуги"===t.target.value?databaseService.getServices().then((t=>e(t))):databaseService.getFilterServices("type",t.target.value).then((t=>e(t)))})),(()=>{const e=document.getElementById("modal");document.addEventListener("click",(t=>{t.target.closest(".btn-addItem")&&(e.style.display="flex")}))})()})();